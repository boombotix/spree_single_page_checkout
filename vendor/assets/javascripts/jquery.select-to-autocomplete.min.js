!function(e){var t={sort:!1,"sort-attr":"data-priority","sort-desc":!1,autoselect:!0,"alternative-spellings":!0,"alternative-spellings-attr":"data-alternative-spellings","remove-valueless-options":!0,"copy-attributes-to-text-field":!0,"autocomplete-plugin":"jquery_ui","relevancy-sorting":!0,"relevancy-sorting-partial-match-value":1,"relevancy-sorting-strict-match-value":5,"relevancy-sorting-booster-attr":"data-relevancy-booster",handle_invalid_input:function(e){e.$text_field.val(e.$select_field.find("option:selected:first").text())},handle_select_field:function(e){return e.hide()},insert_text_field:function(n){var i=e("<input></input>");if(t["copy-attributes-to-text-field"]){for(var r={},a=n.$select_field[0].attributes,l=0;l<a.length;l++){var s=a[l].nodeName,o=a[l].value;"name"!==s&&"id"!==s&&"undefined"!=typeof n.$select_field.attr(s)&&(r[s]=o)}i.attr(r)}return i.blur(function(){var r=n.$select_field.find("option").map(function(t,n){return e(n).text()});e.inArray(i.val(),r)<0&&"function"==typeof t.handle_invalid_input&&t.handle_invalid_input(n)}),n.settings.autoselect&&i.click(function(){this.select()}),i.val(n.$select_field.find("option:selected:first").text()).insertAfter(n.$select_field)},extract_options:function(n){var i=[],r=n.find("option"),a=r.length;return r.each(function(){var n=e(this),r={"real-value":n.attr("value"),label:n.text()};if(t["remove-valueless-options"]&&""===r["real-value"]);else{r.matches=r.label;var l=n.attr(t["alternative-spellings-attr"]);if(l&&(r.matches+=" "+l),t.sort){var s=parseInt(n.attr(t["sort-attr"]),10);r.weight=s?s:a}if(t["relevancy-sorting"]){r["relevancy-score"]=0,r["relevancy-score-booster"]=1;var o=parseFloat(n.attr(t["relevancy-sorting-booster-attr"]));o&&(r["relevancy-score-booster"]=o)}i.push(r)}}),t.sort&&(t["sort-desc"]?i.sort(function(e,t){return t.weight-e.weight}):i.sort(function(e,t){return e.weight-t.weight})),i}},n={init:function(n){return/msie/.test(navigator.userAgent.toLowerCase())&&parseInt(navigator.appVersion,10)<=6?this:(t=e.extend(t,n),this.each(function(){var n=e(this),r={$select_field:n,options:t.extract_options(n),settings:t};r.$text_field=t.insert_text_field(r),t.handle_select_field(n),"string"==typeof t["autocomplete-plugin"]?i[t["autocomplete-plugin"]](r):t["autocomplete-plugin"](r)}))}},i={jquery_ui:function(t){var n=function(n){for(var i=n.split(" "),r=[],a=0;a<i.length;a++)if(i[a].length>0){var l={};l.partial=new RegExp(e.ui.autocomplete.escapeRegex(i[a]),"i"),t.settings["relevancy-sorting"]&&(l.strict=new RegExp("^"+e.ui.autocomplete.escapeRegex(i[a]),"i")),r.push(l)}return e.grep(t.options,function(e){var i=0;if(t.settings["relevancy-sorting"])var a=!1,l=e.matches.split(" ");for(var s=0;s<r.length;s++)if(r[s].partial.test(e.matches)&&i++,t.settings["relevancy-sorting"])for(var o=0;o<l.length;o++)if(r[s].strict.test(l[o])){a=!0;break}if(t.settings["relevancy-sorting"]){var c=0;c+=i*t.settings["relevancy-sorting-partial-match-value"],a&&(c+=t.settings["relevancy-sorting-strict-match-value"]),c*=e["relevancy-score-booster"],e["relevancy-score"]=c}return!n||r.length===i})},i=function(e){if(e)t.$select_field.val()!==e["real-value"]&&(t.$select_field.val(e["real-value"]),t.$select_field.change());else{for(var n=t.$text_field.val().toLowerCase(),i={"real-value":!1},r=0;r<t.options.length;r++)if(n===t.options[r].label.toLowerCase()){i=t.options[r];break}t.$select_field.val()!==i["real-value"]&&(t.$select_field.val(i["real-value"]||""),t.$select_field.change()),i["real-value"]&&t.$text_field.val(i.label),"function"==typeof t.settings.handle_invalid_input&&""===t.$select_field.val()&&t.settings.handle_invalid_input(t)}};t.$text_field.autocomplete({minLength:0,delay:0,autoFocus:!0,source:function(e,i){var r=n(e.term);t.settings["relevancy-sorting"]&&(r=r.sort(function(e,t){return t["relevancy-score"]-e["relevancy-score"]})),i(r)},select:function(e,t){i(t.item)},change:function(e,t){i(t.item)}}),t.$text_field.parents("form:first").submit(function(){i()}),i()}};e.fn.selectToAutocomplete=function(t){return n[t]?n[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?(e.error("Method "+t+" does not exist on jQuery.fn.selectToAutocomplete"),void 0):n.init.apply(this,arguments)}}(jQuery);